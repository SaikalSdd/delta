// RUN: %delta -print-ir %s | %FileCheck %s

struct X {
    init() {}
    deinit() {}
}

// CHECK: define i32 @main()
func main() {
    // CHECK-NEXT: %x = alloca {}
    // CHECK-NEXT: %1 = alloca {}

    // CHECK-NEXT: call void @X.init({}* %x)
    var x = X();

    // CHECK-NEXT: call void @X.deinit({}* %x)

    // TODO: Optimize this into only an init call.
    // CHECK-NEXT: call void @X.init({}* %1)
    // CHECK-NEXT: %2 = load {}, {}* %1
    // CHECK-NEXT: store {} %2, {}* %x
    // CHECK-NEXT: call void @X.deinit({}* %x)
    x = X();

    // CHECK-NEXT: ret i32 0
}
