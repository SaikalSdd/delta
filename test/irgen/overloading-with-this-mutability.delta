// RUN: %delta -print-ir %s | %FileCheck %s
// RUN: %delta -print-ir %s | %FileCheck %s -check-prefix=CHECK-MUTATING
// RUN: %delta -print-ir %s | %FileCheck %s -check-prefix=MAIN

struct A {
    init() {}

    // CHECK: define void @_EN4main1A3fooE({}* %this)
    // CHECK-NEXT: %a = alloca i32
    def foo() {
        var a = 1;
    }

    // CHECK-MUTATING: define void @_ENM4main1A3fooE({}* %this)
    // CHECK-MUTATING-NEXT: %b = alloca i32
    mutating def foo() {
        var b = 1;
    }
}

def main() {
    var a: A* = allocate(A());
    var b = A();

    // MAIN: call void @_EN4main1A3fooE({}* %a1)
    a.foo();

    // MAIN-NEXT: call void @_ENM4main1A3fooE({}* %b)
    b.foo();
}
