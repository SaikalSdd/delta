// RUN: check_matches_snapshot %s.ll %delta -print-ir %s

interface H {
    def h(): int;
}

struct R: Copyable {
    var i: int;

    def h(): int {
        return i;
    }
}

struct A<T> {
    var t: T;

    init() {
        t = undefined;
    }

    def [](i: int): T {
        return t;
    }
}

struct S<E: H> {
    var a: A<A<E>>;

    init() {
        a = undefined;
    }

    def s() {
        var t = a[0];
        var tt = t[0];
        _ = a[tt.h()];
    }
}

def main() {
    var s = S<R>();
    s.s();
}
