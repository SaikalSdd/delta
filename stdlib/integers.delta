// TODO: Remove code duplication by declaring an 'Integer' interface that implements the 'compare'
// function for all integer types.

// TODO: Improve printTo() implementations: optimize + don't depend on libc + don't assume size of int.

private def printSigned<T>(value: T, stream: mutable String*) {
    var result: char[22] = undefined;
    sprintf(result, "%lld", value);
    stream.write(StringRef(result));
}

private def printUnsigned<T>(value: T, stream: mutable String*) {
    var result: char[22] = undefined;
    sprintf(result, "%llu", value);
    stream.write(StringRef(result));
}

struct int: Copyable, Comparable, Printable, Hashable {
    def compare(other: int*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printSigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct int8: Copyable, Comparable, Printable, Hashable {
    def compare(other: int8*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printSigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct int16: Copyable, Comparable, Printable, Hashable {
    def compare(other: int16*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printSigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct int32: Copyable, Comparable, Printable, Hashable {
    def compare(other: int32*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printSigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct int64: Copyable, Comparable, Printable, Hashable {
    def compare(other: int64*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printSigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct uint: Copyable, Comparable, Printable, Hashable {
    def compare(other: uint*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printUnsigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct uint8: Copyable, Comparable, Printable, Hashable {
    def compare(other: uint8*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printUnsigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct uint16: Copyable, Comparable, Printable, Hashable {
    def compare(other: uint16*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printUnsigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct uint32: Copyable, Comparable, Printable, Hashable {
    def compare(other: uint32*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printUnsigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}

struct uint64: Copyable, Comparable, Printable, Hashable {
    def compare(other: uint64*): Ordering {
        return (this < *other) ? Ordering.Less : (this > *other) ? Ordering.Greater : Ordering.Equal;
    }

    def printTo(stream: mutable String*) {
        printUnsigned(this, stream);
    }

    def hash(): uint64 {
        return uint64(this);
    }
}
